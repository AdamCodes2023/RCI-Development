(this["webpackJsonpelectron-m5burner-v2-web"]=this["webpackJsonpelectron-m5burner-v2-web"]||[]).push([[0],Array(18).concat([function(e,t,a){e.exports=a(43)},,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(11),l=a.n(o),c=a(3),s=a(9),i=a(1),u="light",m="dark",d="fade-in",p="fade-out",f="downloading",v="end",b="error",h=["1500000","921600","750000","512000","256000","230400","115200"],E="SET_THEME",g="SET_LANGUAGE",w="SET_BURN_PARAMS",y="SET_VERSION",O="SET_LASTEST_VERSION";function C(e){return{type:E,payload:e}}function k(e){return{type:w,payload:e}}var N={theme:u,language:"en",burnParams:{flashMode:"dio",flashFrequency:"80m",flashSize:"detect"},version:"",lastest:""};var S="OPEN_MODAL",M="CLOSE_MODAL",j="SET_ANIMATION_STATE";function T(e){return Object(i.a)({type:S},e)}function H(e){return Object(i.a)({type:j},e)}var F={visiable:!1,component:null,animation:""};var D="SET_COM",P="SET_BAUDRATE";function _(e){return Object(i.a)({type:P},e)}var A={com:"",baudrate:"1500000"};var B="START_STDOUT",x="APPEND_STDOUT";function R(e){return{type:B,payload:e}}function L(e){return{type:x,payload:e}}var I={message:""};var U="GET_FIRMWARE",z="UPDATE_FIRMWARES",q="SELECT_FIRMWARE_TYPE",G="UPDATE_DOWNLOAD_STATUS",V="SEARCH_FIRMWARE";var W={list:{core:[],stickc:[],atom:[]},raw:{core:[],stickc:[],atom:[]},selected:"core",keyword:""};var J=Object(s.b)({global:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:case g:return Object(i.a)({},e,{},t.payload);case w:return Object(i.a)({},e,{burnParams:Object(i.a)({},e.burnParams,{},t.payload)});case y:case O:return Object(i.a)({},e,{},t.payload);default:return e}},modal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(i.a)({},e,{visiable:!0,component:t.component});case M:return Object(i.a)({},e,{visiable:!1,component:null});case j:return Object(i.a)({},e,{animation:t.animation});default:return e}},burn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object(i.a)({},e,{com:t.com});case P:return Object(i.a)({},e,{baudrate:t.baudrate});default:return e}},stdout:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:return{message:t.payload.message};case x:return{message:e.message+t.payload.message};default:return e}},firmware:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:return Object(i.a)({},e,{list:t.payload,raw:t.payload});case z:var a=JSON.parse(JSON.stringify(t.payload));return Object(i.a)({},e,{list:a});case q:return Object(i.a)({},e,{selected:t.payload});case G:return(a=(n=JSON.parse(JSON.stringify(e))).list[t.payload.type]).forEach((function(e){if(e.name===t.payload.name){var a=e.versions.find((function(e){return e.version===t.payload.version}));a.downloadStatus=t.payload.downloadStatus,a.progress=t.payload.progress,t.payload.downloadStatus===v&&(a.exist=!0)}})),Object(i.a)({},e,{},n);case V:var n=JSON.parse(JSON.stringify(e));if(""===t.payload)return Object(i.a)({},n,{list:n.raw});var r={};for(var o in n.list)r[o]=n.raw[o].filter((function(e){return e.name.toUpperCase().includes(t.payload.toUpperCase())}));return Object(i.a)({},n,{list:r});default:return e}}}),K=Object(s.c)(J),Y=a(4),Q=a.n(Y),X=window.require("electron").ipcRenderer,Z="Minimize",$="Maximize",ee="Quit",te="GetPorts",ae="Erase",ne="Burn",re="SaveConfig",oe="LoadAllConfig",le="WatchCOM",ce="CloseCOM",se="GetFirmwares",ie="DownloadFirmware",ue="RemoveFirmware",me="WriteCOM",de="Update",pe="GetSttToken",fe=function(e,t,a){var n="".concat(e,"Callback");X.eventNames().includes(n)||X.on(n,(function(e,t){a&&a(t)})),X.send(e,t)},ve=function(e,t,a){var n="".concat(e,"Callback");X.eventNames().includes(n)||X.once(n,(function(e,t){a&&a(t)})),X.send(e,t)},be=function(e,t,a,n){var r="".concat(t,"Callback-").concat(e);X.eventNames().includes(r)||X.on(r,(function(e,t){n&&n(t)})),X.send(t,a)},he=a(10),Ee=a(5),ge=a(6),we=a(2),ye=a(7),Oe=a(8);a(29);var Ce=Object(c.b)((function(e){return{config:e.global}}),{})((function(e){var t=e.onClose,a=e.config,o=e.onChange,l=e.onUpdate,c=Object(n.useRef)();Object(n.useEffect)((function(){var e=setTimeout((function(){c.current.classList.add("slide-in")}));return function(){c.current.classList.remove("slide-in"),c.current.classList.add("slide-out"),clearTimeout(e)}}),[]);var s=function(){c.current.classList.remove("slide-in"),c.current.classList.add("slide-out"),setTimeout((function(){t()}),250)},i=function(e,t){o(e,t)};return r.a.createElement("div",{className:"wrapper-panel-preference",onClick:s},r.a.createElement("div",{className:"panel-preference",ref:c,onClick:function(e){return e.stopPropagation()}},r.a.createElement("h2",null,"Preference"),r.a.createElement("form",{className:"form-preference"},r.a.createElement("h3",null,"General"),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",null,"Theme"),r.a.createElement("select",{value:a.theme,onChange:function(e){o("theme",e.target.value)}},r.a.createElement("option",{value:u},"Light"),r.a.createElement("option",{value:m},"Dark"))),r.a.createElement("h3",null,"Advanced"),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",null,"Flash Frequency"),r.a.createElement("select",{value:a.burnParams.flashFrequency,onChange:function(e){return i("flashFrequency",e.target.value)}},r.a.createElement("option",{value:"80m"},"80m"),r.a.createElement("option",{value:"40m"},"40m"),r.a.createElement("option",{value:"26m"},"26m"),r.a.createElement("option",{value:"20m"},"20m"),r.a.createElement("option",{value:"keep"},"Keep"))),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",null,"Flash Size"),r.a.createElement("select",{value:a.burnParams.flashSize,onChange:function(e){return i("flashSize",e.target.value)}},r.a.createElement("option",{value:"detect"},"Detect"),r.a.createElement("option",{value:"16mb"},"16MB"),r.a.createElement("option",{value:"4mb"},"4MB"),r.a.createElement("option",{value:"2mb"},"2MB"),r.a.createElement("option",{value:"1mb"},"1MB"))),r.a.createElement("h3",null,"Version"),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",null,"Current: ",a.version)),r.a.createElement("div",{className:"form-item"},r.a.createElement("label",null,"Lastest: ",a.lastest),a.lastest>a.version?r.a.createElement("a",{className:"btn-update",onClick:l},"Update"):null)),r.a.createElement("footer",null,r.a.createElement("button",{className:"btn cancel",onClick:s},"Back"))))})),ke=(a(30),function(e){Object(Oe.a)(a,e);var t=Object(ye.a)(a);function a(){var e;return Object(Ee.a)(this,a),(e=t.call(this)).maximize=e.maximize.bind(Object(we.a)(e)),e.minimize=e.minimize.bind(Object(we.a)(e)),e.quit=e.quit.bind(Object(we.a)(e)),e.update=e.update.bind(Object(we.a)(e)),e.openPreferencePanel=e.openPreferencePanel.bind(Object(we.a)(e)),e.changeSelectorHandler=e.changeSelectorHandler.bind(Object(we.a)(e)),e}return Object(ge.a)(a,[{key:"openPreferencePanel",value:function(){if(!this.props.modal.visiable){var e=this.props.hideModal;this.props.openModal(r.a.createElement(Ce,{onChange:this.changeSelectorHandler,onClose:e,onUpdate:this.update}))}}},{key:"changeSelectorHandler",value:function(e,t){"theme"===e?(this.props.setTheme(t),fe(re,{key:e,value:t})):(this.props.setBurnParams(e,t),fe(re,{key:"burnParams",value:Object(he.a)({},e,t)}))}},{key:"maximize",value:function(){fe($,null,null)}},{key:"minimize",value:function(){fe(Z,null,null)}},{key:"quit",value:function(){fe(ee,null,null)}},{key:"update",value:function(){var e=this;window.swal({title:"Tips",text:"Do you sure to update?",icon:"warning",buttons:{confirm:{text:"Yes",closeModal:!1,value:!0},cancel:{text:"No",closeModal:!1,value:!1,visible:!0}},closeOnClickOutside:!1,closeOnEsc:!1}).then((function(t){if(!t)return window.swal.getState().actions.cancel.closeModal=!0,window.swal.stopLoading(),void window.swal.close();document.getElementsByClassName("swal-title")[0].style.display="none",fe(de,{lastest:e.props.global.lastest},(function(e){var t=document.getElementsByClassName("swal-text")[0];return!1===e?(t.innerText="Download update failed.",window.swal.getState().actions.confirm.closeModal=!0,window.swal.getState().actions.cancel.closeModal=!0,void window.swal.stopLoading()):!0===e?(t.innerText="Update successfully. Restart takes effect",window.swal.getState().actions.confirm.closeModal=!0,window.swal.getState().actions.cancel.closeModal=!0,void window.swal.stopLoading()):void(t.innerText="Update ... (".concat(100*e,"%)"))}))}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"app-top-bar"},r.a.createElement("div",{className:"logo"},r.a.createElement("img",{className:"topbar-logo",src:"assets/images/logo.png"}),r.a.createElement("span",null,"M5Burner-Beta")),r.a.createElement("div",{className:"control-box"},r.a.createElement("button",{className:"btn-control btn-setting",onClick:this.openPreferencePanel},r.a.createElement("i",{className:"iconfont icon-setting"})),r.a.createElement("button",{className:"btn-control btn-min",onClick:this.minimize},r.a.createElement("i",{className:"iconfont icon-zuixiaohua"})),r.a.createElement("button",{className:"btn-control btn-max",onClick:this.maximize},r.a.createElement("i",{className:"iconfont icon-zuidahua"})),r.a.createElement("button",{className:"btn-control btn-close",onClick:this.quit},r.a.createElement("i",{className:"iconfont icon-guanbi"}))))}}]),a}(r.a.Component)),Ne=Object(c.b)((function(e){return{modal:e.modal,global:e.global}}),(function(e){return{openModal:function(t){return e(T({component:t}))},hideModal:function(t){return e(H({animation:p}))},setTheme:function(t){return e(C({theme:t}))},setBurnParams:function(t,a){return e(k(Object(he.a)({},t,a)))}}}))(ke);var Se=function(e){var t=e.icon,a=e.field,n=e.value,o=e.options,l=e.onChange,c=e.onClick;return r.a.createElement("li",{className:"header-form-item"},r.a.createElement("i",{className:Q()("iconfont",t)}),r.a.createElement("span",null,a,":"),r.a.createElement("select",{value:n,onChange:l,onClick:c},o.map((function(e){return r.a.createElement("option",{key:e,value:e},e)}))))};a(31),a(32);var Me=Object(c.b)((function(e){return{stdout:e.stdout}}),(function(e){return{}}))((function(e){var t=Object(n.useRef)(null);return Object(n.useEffect)((function(){t.current.scrollTo(0,t.current.scrollHeight)}),[e.stdout.message]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"wrapper-serial-log",ref:t},r.a.createElement("pre",null,e.stdout.message)),e.footer)})),je=(a(33),window.require("electron").ipcRenderer),Te=function(e){Object(Oe.a)(a,e);var t=Object(ye.a)(a);function a(){var e;return Object(Ee.a)(this,a),(e=t.call(this)).state={coms:[],ssid:localStorage.getItem("ssid")||"",password:localStorage.getItem("password")||""},e.changeCOMHandler=e.changeCOMHandler.bind(Object(we.a)(e)),e.changeBaudrateHandler=e.changeBaudrateHandler.bind(Object(we.a)(e)),e.refreshCOMs=e.refreshCOMs.bind(Object(we.a)(e)),e.erase=e.erase.bind(Object(we.a)(e)),e.watchCOM=e.watchCOM.bind(Object(we.a)(e)),e.updateSSID=e.updateSSID.bind(Object(we.a)(e)),e.updatePassword=e.updatePassword.bind(Object(we.a)(e)),e}return Object(ge.a)(a,[{key:"componentWillMount",value:function(){this._getPorts()}},{key:"_getPorts",value:function(){var e=this;fe(te,null,(function(t){e.setState({coms:t.map((function(e){return e.path}))},(function(){t.length>0&&""===e.props.com&&e.props.setCOM(e.state.coms[0])}))}))}},{key:"refreshCOMs",value:function(){this._getPorts()}},{key:"changeCOMHandler",value:function(e){this.props.setCOM(e.target.value)}},{key:"changeBaudrateHandler",value:function(e){this.props.setBaudrate(e.target.value),fe(re,{key:"baudrate",value:e.target.value})}},{key:"erase",value:function(e){var t=this;e.preventDefault();var a=this.props.closeModal,n=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"footer-btn"},r.a.createElement("button",{onClick:a},"Close")));this.props.openModal(r.a.createElement(Me,{footer:n})),this.props.startStdoutMessage("=================\nErase now\n=================\n"),fe(ae,{com:this.props.com},(function(e){t.props.appendStdoutMessage(e)}))}},{key:"watchCOM",value:function(e){var t=this;e.preventDefault();var a=this,n=this.props.closeModal,o=function(){var e=function(){var e=document.getElementById("_sendbox").value;fe(me,{com:a.props.com,data:e},null)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"footer-btn"},r.a.createElement("textarea",{id:"_sendbox",className:"sendbox",type:"text",onKeyPress:function(t){13===t.charCode&&t.ctrlKey&&e()}}),r.a.createElement("button",{className:"send",onClick:e},"Send"),r.a.createElement("button",{onClick:function(){je.eventNames().includes("".concat(le,"Callback"))&&fe(ce,null),n()}},"Close")))}();this.props.openModal(r.a.createElement(Me,{footer:o,com:this.props.com})),this.props.startStdoutMessage("=================\n".concat(this.props.com,"\n=================\n")),fe(le,{com:this.props.com},(function(e){t.props.appendStdoutMessage(e)}))}},{key:"updateSSID",value:function(e){this.setState({ssid:e.target.value}),localStorage.setItem("ssid",e.target.value)}},{key:"updatePassword",value:function(e){this.setState({password:e.target.value}),localStorage.setItem("password",e.target.value)}},{key:"render",value:function(){var e=this.props,t=e.com,a=e.baudrate;return r.a.createElement("form",{className:"header-form"},r.a.createElement(Se,{icon:"icon-usb",field:"COM",value:t,options:this.state.coms,onChange:this.changeCOMHandler,onClick:this.refreshCOMs}),r.a.createElement(Se,{icon:"",field:"Baudrate",value:a,options:h,onChange:this.changeBaudrateHandler}),r.a.createElement("li",{className:"header-form-item"},r.a.createElement("span",null,"SSID:"),r.a.createElement("input",{type:"text",value:this.state.ssid,onChange:this.updateSSID})),r.a.createElement("li",{className:"header-form-item"},r.a.createElement("span",null,"Password:"),r.a.createElement("input",{type:"text",value:this.state.password,onChange:this.updatePassword})),r.a.createElement("button",{className:"btn erase",onClick:this.erase},r.a.createElement("i",{className:"iconfont icon-erase"}),r.a.createElement("span",null,"Erase")),r.a.createElement("button",{className:"btn open",onClick:this.watchCOM},r.a.createElement("i",{className:"iconfont icon-usb"}),r.a.createElement("span",null,"COM Monitor")))}}]),a}(r.a.Component),He=Object(c.b)((function(e){return{com:e.burn.com,baudrate:e.burn.baudrate}}),(function(e){return{openModal:function(t){return e(T({component:t}))},closeModal:function(t){return e(H({animation:p}))},setBaudrate:function(t){return e(_({baudrate:t}))},setCOM:function(t){return e((a={com:t},Object(i.a)({type:D},a)));var a},startStdoutMessage:function(t){return e(R({message:t}))},appendStdoutMessage:function(t){return e(L({message:t}))}}}))(Te),Fe=(a(34),function(e){Object(Oe.a)(a,e);var t=Object(ye.a)(a);function a(){return Object(Ee.a)(this,a),t.apply(this,arguments)}return Object(ge.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"app-header"},r.a.createElement(He,null))}}]),a}(r.a.Component)),De=Object(c.b)((function(e){return{}}),(function(e){return{}}))(Fe);a(35);var Pe=function(e){var t=e.selected,a=e.setSelected,n=[{name:"core",light:"light-core.png",dark:"dark-core.png"},{name:"stickc",light:"light-stickc.png",dark:"dark-stickc.png"},{name:"atom",light:"light-atom.png",dark:"dark-atom.png"}].map((function(e){return r.a.createElement("li",{key:e.name,className:Q()("item-device",t===e.name?"selected":""),onClick:function(){return a(e.name)}},r.a.createElement("figure",null,r.a.createElement("img",{className:"avatar",src:"./assets/images/"+e.light,alt:e.name,draggable:"false"}),r.a.createElement("figcaption",null,e.name.toUpperCase())))}));return r.a.createElement("ul",{className:"list-device"},n)};a(36);var _e=function(e){var t=e.onChange;return r.a.createElement("div",{className:"search-box"},r.a.createElement("input",{placeholder:"Search ... ",onChange:t}))},Ae=a(17),Be=(a(37),window.require("electron").ipcRenderer);var xe=Object(c.b)((function(e){return{com:e.burn.com,selectedType:e.firmware.selected}}),(function(e){return{openModal:function(t){return e(T({component:t}))},closeModal:function(t){return e(H({animation:p}))},startStdoutMessage:function(t){return e(R({message:t}))},appendStdoutMessage:function(t){return e(L({message:t}))}}}))((function(e){var t=e.firmware,a=e.downloadHanlder,o=e.removeHandler,l=e.device;e.selectedType,t.versions.sort((function(e,t){return Date.parse(new Date(t.publishAt))-Date.parse(new Date(e.publishAt))}));var c=Object(n.useState)({}),s=Object(Ae.a)(c,2),u=s[0],m=s[1],d=Object(n.useRef)(null);Object(n.useEffect)((function(){var e=0;null!=d&&(e=t.versions.findIndex((function(e){return e.version===d.current.value}))),m(t.versions[e])}),[t,u]);var p=t.versions.map((function(e){return r.a.createElement("option",{key:e.version},e.version)}));return r.a.createElement("div",{className:Q()("wrapper-item-firmware")},r.a.createElement("article",{className:"item"},r.a.createElement("h2",null,r.a.createElement("span",null,t.name),"M5Stack"===t.publisher?r.a.createElement("span",{className:"tag"},"official"):null,r.a.createElement("select",{className:"selector-version",onChange:function(t){m(e.firmware.versions.find((function(e){return e.version===t.target.value})))},ref:d},p)),r.a.createElement("p",null,t.description),r.a.createElement("div",{className:"footer"},u.exist?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn remove",onClick:function(){return o({name:t.name,version:u.version})}},r.a.createElement("div",{className:"mask"}),r.a.createElement("i",{className:"iconfont icon-delete"}),r.a.createElement("span",null,"Remove")),"ECHOSTT"===t.name.toUpperCase()?r.a.createElement("button",{className:"btn remove",onClick:function(){!function(e){var t=e.closeModal,a={com:e.com},n=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"footer-btn"},r.a.createElement("button",{onClick:function(){var e="".concat(pe,"Callback-").concat(a.com);Be.eventNames().includes(e)&&Be.off(e,Be.listeners(e)[0]),t()}},"Close")));e.openModal(r.a.createElement(Me,{footer:n,com:a.com})),e.startStdoutMessage("=================\nGet Echo STT Token\n=================\n"),be(a.com,pe,a,(function(t){e.appendStdoutMessage(t)}))}(e)}},r.a.createElement("div",{className:"mask"}),r.a.createElement("span",null,"Get Token")):null,r.a.createElement("button",{className:"btn burn",onClick:function(){return function(e){var t=e.closeModal,a={com:e.com,name:e.firmware.name,version:e.version,type:e.type},n=localStorage.getItem("ssid"),o=localStorage.getItem("password");void 0!=n&&void 0!=o&&""!=n&&""!=o&&(a.ssid=n,a.password=o);var l=r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"footer-btn"},r.a.createElement("button",{onClick:function(){var e="".concat(ne,"Callback-").concat(a.com);Be.eventNames().includes(e)&&Be.off(e,Be.listeners(e)[0]),t()}},"Close")));e.openModal(r.a.createElement(Me,{footer:l,com:a.com})),e.startStdoutMessage("=================\nStart Burn\n=================\n"),be(a.com,ne,a,(function(t){e.appendStdoutMessage(t)}))}(Object(i.a)({},e,{version:u.version,type:l}))}},r.a.createElement("div",{className:"mask"}),r.a.createElement("i",{className:"iconfont icon-hot-or-burn-interface-symbol"}),r.a.createElement("span",null,"Burn"))):r.a.createElement("button",{className:Q()("btn","download",u.downloadStatus===f?"downloading":""),onClick:function(){return a({name:t.name,version:u.version,type:l})}},r.a.createElement("div",{className:"mask"}),function(e){var t=e.selectedVersion;if(!t.downloadStatus)return r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"iconfont icon-clouddownload"}),r.a.createElement("span",null,"Download"));switch(t.downloadStatus){case f:var a={width:115*t.progress+"px"};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"progress",style:a}),r.a.createElement("span",null,"Downloading"));case b:return r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"iconfont icon-clouddownload"}),r.a.createElement("span",null,"Retry"));default:return r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"iconfont icon-clouddownload"}),r.a.createElement("span",null,"Download"))}}({selectedVersion:u})))))}));a(38);var Re=function(e){var t=e.firmwareList,a=e.downloadHanlder,n=e.removeHandler,o=e.device,l=t.map((function(e,t){return r.a.createElement(xe,{key:t,device:o,firmware:e,downloadHanlder:a,removeHandler:n})}));return r.a.createElement("div",{className:"list-firmware"},l)};a(39);function Le(){return r.a.createElement("div",{className:"ball-pulse-sync"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))}a(40);var Ie=window.require("electron").ipcRenderer,Ue=function(e){Object(Oe.a)(a,e);var t=Object(ye.a)(a);function a(e){var n;return Object(Ee.a)(this,a),(n=t.call(this,e)).state={loading:!0},n.downloadHanlder=n.downloadHanlder.bind(Object(we.a)(n)),n.removeHanlder=n.removeHanlder.bind(Object(we.a)(n)),n._updateFirmwares=n._updateFirmwares.bind(Object(we.a)(n)),n.setCurrentDevice=n.setCurrentDevice.bind(Object(we.a)(n)),n.inputChangeHandler=n.inputChangeHandler.bind(Object(we.a)(n)),n}return Object(ge.a)(a,[{key:"componentWillMount",value:function(){this._getFirmwares()}},{key:"_getFirmwares",value:function(){var e=this;this.setState({loading:!0}),ve(se,null,(function(t){e.setState({loading:!1}),null!==t&&e.props.getFirmwares(t)}))}},{key:"_updateFirmwares",value:function(){var e=this;ve(se,null,(function(t){null!==t&&e.props.updateFirmwares(t)}))}},{key:"removeHanlder",value:function(e){var t=this,a=this._updateFirmwares;window.swal({title:"Tips",text:"Do you sure to delete this firmware?",icon:"warning",buttons:{ok:"Yes",cancel:"No"}}).then((function(n){if("ok"==n){var r=e.name,o=e.version,l=t.props.firmware.selected;fe(ue,{firmware:r,version:o,type:l},(function(e){e&&a()}))}}))}},{key:"downloadHanlder",value:function(e){var t=this._updateFirmwares,a=e.name,n=e.version,r=e.type,o="".concat(ie,"Callback-").concat(a,"-").concat(r,"-").concat(n),l=this.props.updateFirmwareDownloadStatus;Ie.send(ie,{firmware:a,version:n,type:r}),Ie.eventNames().includes(o)||Ie.on(o,(function(e,c){if(null!==c)return"end"===c?(l({name:a,version:n,type:r,downloadStatus:b,progress:0}),void Ie.off(o,this.listeners(o)[0])):1==c?(l({name:a,version:n,type:r,downloadStatus:v,progress:1}),Ie.off(o,this.listeners(o)[0]),void t()):void l({name:a,version:n,type:r,downloadStatus:f,progress:c})}))}},{key:"setCurrentDevice",value:function(e){var t="1500000";switch(e){case"core":t="1500000";break;case"stickc":case"atom":t="750000"}this.props.setSelectedDeviceType(e),this.props.setBaudrate(t),fe(re,{key:"baudrate",value:t})}},{key:"inputChangeHandler",value:function(e){this.props.searchFirmware(e.target.value)}},{key:"render",value:function(){var e=this.state.loading,t=this.props.firmware,a=t.list,n=t.selected;return r.a.createElement("div",{className:"container-firmware"},r.a.createElement(Pe,{selected:n,setSelected:this.setCurrentDevice}),r.a.createElement("div",{className:"wrapper-firmware-list"},e?r.a.createElement(Le,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(_e,{onChange:this.inputChangeHandler}),r.a.createElement("div",{className:Q()("list","core"===n?"active":"")},r.a.createElement(Re,{device:"core",firmwareList:a.core,downloadHanlder:this.downloadHanlder,removeHandler:this.removeHanlder})),r.a.createElement("div",{className:Q()("list","stickc"===n?"active":"")},r.a.createElement(Re,{device:"stickc",firmwareList:a.stickc,downloadHanlder:this.downloadHanlder,removeHandler:this.removeHanlder})),r.a.createElement("div",{className:Q()("list","atom"===n?"active":"")},r.a.createElement(Re,{device:"atom",firmwareList:a.atom,downloadHanlder:this.downloadHanlder,removeHandler:this.removeHanlder})))))}}]),a}(r.a.Component),ze=Object(c.b)((function(e){return{firmware:e.firmware}}),(function(e){return{getFirmwares:function(t){return e({type:U,payload:t})},updateFirmwares:function(t){return e({type:z,payload:t})},setSelectedDeviceType:function(t){return e({type:q,payload:t})},updateFirmwareDownloadStatus:function(t){return e(function(e){return{type:G,payload:e}}(t))},setBaudrate:function(t){return e(_({baudrate:t}))},searchFirmware:function(t){return e({type:V,payload:t})}}}))(Ue),qe=(a(41),function(e){Object(Oe.a)(a,e);var t=Object(ye.a)(a);function a(e){var n;return Object(Ee.a)(this,a),(n=t.call(this,e)).beforeCloseModal=n.beforeCloseModal.bind(Object(we.a)(n)),n}return Object(ge.a)(a,[{key:"beforeCloseModal",value:function(){this.props.setAnimation(p)}},{key:"shouldComponentUpdate",value:function(e){var t=this;return this.props.modal.visiable!==e.modal.visiable&&e.modal.visiable&&setTimeout((function(){t.props.setAnimation(d)})),this.props.modal.animation!==e.modal.animation&&e.modal.animation===p&&setTimeout((function(){t.props.closeModal()}),250),!0}},{key:"render",value:function(){var e=this.props.modal,t=e.visiable,a=e.component,n=e.animation;return t?r.a.createElement("div",{className:Q()("full-main",n)},r.a.createElement("div",{className:"mask",onClick:this.beforeCloseModal}),r.a.createElement("div",{className:"modal"},a)):null}}]),a}(r.a.Component)),Ge=Object(c.b)((function(e){return{modal:e.modal}}),(function(e){return{closeModal:function(t){return e({type:M})},setAnimation:function(t){return e(H({animation:t}))}}}))(qe);a(42);var Ve=Object(c.b)((function(e){return{theme:e.global.theme}}),(function(e){return{setTheme:function(t){return e(C({theme:t}))},setBaudrate:function(t){return e(_({baudrate:t}))},setBurnParams:function(t){return e(k(Object(i.a)({},t)))},setVersion:function(t){return e({type:y,payload:{version:t}})},setLastestVersion:function(t){return e({type:O,payload:{lastest:t}})}}}))((function(e){var t=e.theme,a=e.setTheme,o=e.setBurnParams,l=e.setBaudrate,c=e.setVersion,s=e.setLastestVersion;return Object(n.useEffect)((function(){fe(oe,null,(function(e){console.log(e),a(e.theme),o(e.burnParams),l(e.baudrate),c(e.version),s(e.lastest)}))}),[]),r.a.createElement("div",{className:Q()("main",t)},r.a.createElement(Ne,null),r.a.createElement(De,null),r.a.createElement(ze,null),r.a.createElement(Ge,null))})),We=function(){return r.a.createElement(c.a,{store:K},r.a.createElement(Ve,null))};l.a.render(r.a.createElement(We,null),document.getElementById("app"))}]),[[18,1,2]]]);
//# sourceMappingURL=main.1cabeb61.chunk.js.map