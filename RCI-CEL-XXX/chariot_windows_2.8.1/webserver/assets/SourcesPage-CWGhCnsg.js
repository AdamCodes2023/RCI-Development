import{Q as M,a as F,b as N,c as A}from"./QTabPanels-Cp3Ya--g.js";import{_ as L,d as T,Q as y,N as h,P as u,f as o,O as l,U as a,V as s,S as m,X as d,aE as w,aK as U,aq as S,M as b,at as D,ar as R,Y as v,aN as O,aO as E,au as G}from"./index-NBAmjDPo.js";import{Q as j}from"./QPage-vWYdfFDK.js";import{P as I}from"./PageHeader-Bnmx8R_2.js";import{Q as C,a as P}from"./QTable-BxDh1Klk.js";import{Q as n}from"./QTooltip-B6ZEMbHi.js";import{Q as i}from"./QItemLabel-Bs93CYCt.js";import{Q as H}from"./QSelect-DFMwG8q_.js";import{Q as K}from"./QForm-2fLQLKgE.js";import{B}from"./BasicModal-C1PQ0FKo.js";import{C as X}from"./ConfirmationModal-Dz1SD7zn.js";import{Q as k}from"./QExpansionItem-DjKZC-Oq.js";import"./QResizeObserver-D41I_oPa.js";import"./QMenu-ikSdQUIb.js";import"./QList-Dp5SD6bt.js";import"./QMarkupTable-ByLNg887.js";import"./QToolbar-CdQr3U-3.js";import"./ClosePopup-BPFWk25n.js";const Y=T({name:"ADTemplate",emits:["formChange"],props:{formValues:{type:Object,default:()=>{}}},data(){let e={domain:"",userSearchBase:"",userFullNameAttribute:"name",userSearchFilter:"(&(objectClass=user)(sAMAccountName={0}))",userListFilter:"(&(objectClass=user)(sAMAccountName=*))",userNameAttribute:"sAMAccountName",userGroupAttribute:"memberOf",groupSearchBase:"",groupSearchFilter:"(objectClass=group)",groupNameAttribute:"CN",groupToRoleMapping:"",autoSuffix:!0,systemSuffixPrefix:!0,usernameSuffix:"",usernamePrefix:"",referral:"ignore",connectTimeout:1e4,readTimeout:5e3,cacheTimeout:1e4,enableCache:!0};return U.isEmpty(this.formValues)||(e={...e,...this.formValues}),{form:U.omit(e,["name","enabled","host","port","useTls","sysUsername","sysPassword"])}},watch:{form:{handler(){this.$emit("formChange",this.form)},deep:!0,immediate:!0}}}),z={class:"chariot-form-input q-mt-md"},J={class:"chariot-form-input q-mt-md"},W={class:"chariot-form-input q-mt-md"},Z={class:"chariot-form-input q-mt-md"},_={class:"chariot-form-input q-mt-md"},x={class:"chariot-form-input q-mt-md"},ee={class:"chariot-form-input q-mt-md"},oe={class:"chariot-form-input q-mt-md"},le={class:"chariot-form-input q-mt-md"},te={class:"chariot-form-input q-mt-md"},ae={class:"chariot-form-input q-mt-md"},se={class:"chariot-form-input q-mt-md"},re={class:"chariot-form-input"},ue={class:"chariot-form-input"},ne={class:"chariot-form-input q-mt-md"},me={class:"chariot-form-input q-mt-md"},ie={class:"chariot-form-input q-mt-md"},de={class:"chariot-form-input q-mt-md"},pe={class:"chariot-form-input q-mt-md"};function fe(e,t,c,$,q,g){return h(),y("div",null,[u("label",z,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.domain"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.domain")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.domain,"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.domain=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",J,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.userSearchBase"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.userSearchBase")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userSearchBase,"onUpdate:modelValue":t[1]||(t[1]=r=>e.form.userSearchBase=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",W,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.userFullNameAttribute"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.userFullNameAttribute")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userFullNameAttribute,"onUpdate:modelValue":t[2]||(t[2]=r=>e.form.userFullNameAttribute=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",Z,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.userSearchFilter"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.userSearchFilter")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userSearchFilter,"onUpdate:modelValue":t[3]||(t[3]=r=>e.form.userSearchFilter=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",_,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.userListFilter"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.userListFilter")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userListFilter,"onUpdate:modelValue":t[4]||(t[4]=r=>e.form.userListFilter=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",x,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.usernameAttributeName"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.usernameAttributeName")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userNameAttribute,"onUpdate:modelValue":t[5]||(t[5]=r=>e.form.userNameAttribute=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",ee,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.userGroupAttribute"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.userGroupAttribute")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userGroupAttribute,"onUpdate:modelValue":t[6]||(t[6]=r=>e.form.userGroupAttribute=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",oe,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupSearchBase"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupSearchBase")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupSearchBase,"onUpdate:modelValue":t[7]||(t[7]=r=>e.form.groupSearchBase=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",le,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupSearchFilter"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupSearchFilter")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupSearchFilter,"onUpdate:modelValue":t[8]||(t[8]=r=>e.form.groupSearchFilter=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",te,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupNameAttribute"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupNameAttribute")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupNameAttribute,"onUpdate:modelValue":t[9]||(t[9]=r=>e.form.groupNameAttribute=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",ae,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupToRoleMapping"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupToRoleMapping")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupToRoleMapping,"onUpdate:modelValue":t[10]||(t[10]=r=>e.form.groupToRoleMapping=r),dense:"",outlined:""},null,8,["modelValue"])]),o(k,{"header-class":"chariot-form-collapse-group"},{header:l(()=>[a(s(e.$t("mqttServerLdap.advancedOptions")),1)]),default:l(()=>[u("label",se,[o(i,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.autoSuffix"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.autoSuffix")),1)]),_:1})]),_:1})]),_:1}),o(w,{modelValue:e.form.autoSuffix,"onUpdate:modelValue":t[11]||(t[11]=r=>e.form.autoSuffix=r)},null,8,["modelValue"])]),u("label",re,[o(i,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.systemSuffixPrefix"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.systemSuffixPrefix")),1)]),_:1})]),_:1})]),_:1}),o(w,{modelValue:e.form.systemSuffixPrefix,"onUpdate:modelValue":t[12]||(t[12]=r=>e.form.systemSuffixPrefix=r)},null,8,["modelValue"])]),u("label",ue,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.usernameSuffix"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.usernameSuffix")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.usernameSuffix,"onUpdate:modelValue":t[13]||(t[13]=r=>e.form.usernameSuffix=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",ne,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.usernamePrefix"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.usernamePrefix")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.usernamePrefix,"onUpdate:modelValue":t[14]||(t[14]=r=>e.form.usernamePrefix=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",me,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.referral"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.referral")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.referral,"onUpdate:modelValue":t[15]||(t[15]=r=>e.form.referral=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",ie,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.connectionTimeout"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.connectionTimeout")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.connectTimeout,"onUpdate:modelValue":t[16]||(t[16]=r=>e.form.connectTimeout=r),modelModifiers:{number:!0},type:"number",dense:"",outlined:""},null,8,["modelValue"])]),u("label",de,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.readTimeout"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.readTimeout")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.readTimeout,"onUpdate:modelValue":t[17]||(t[17]=r=>e.form.readTimeout=r),modelModifiers:{number:!0},type:"number",dense:"",outlined:""},null,8,["modelValue"])]),u("label",pe,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.cacheTimeout"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.cacheTimeout")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.cacheTimeout,"onUpdate:modelValue":t[18]||(t[18]=r=>e.form.cacheTimeout=r),modelModifiers:{number:!0},type:"number",dense:"",outlined:""},null,8,["modelValue"])])]),_:1})])}const he=L(Y,[["render",fe]]),ge=T({name:"LDAPTemplate",emits:["formChange"],props:{formValues:{type:Object,default:()=>{}}},data(){let e={userSearchBase:"ou=Users,dc=example,dc=com",userFullNameAttribute:"cn",userDnTemplate:"uid={0},ou=users,dc=example,dc=com",userListFilter:"(&(objectClass=inetOrgPerson)(uid=*))",userNameAttribute:"uid",userGroupAttribute:"groupOfNames",groupSearchBase:"ou=groups,dc=example,dc=com",groupSearchFilter:"(objectClass=groupOfNames)",groupNameAttribute:"cn",groupMemberAttribute:"member",groupMemberDnTemplate:null,groupToRoleMapping:"",referral:"ignore",connectTimeout:1e4,readTimeout:5e3,cacheTimeout:1e4,enableCache:!0};return U.isEmpty(this.formValues)||(e={...e,...this.formValues}),{form:U.omit(e,["name","enabled","host","port","useTls","sysUsername","sysPassword"])}},watch:{form:{handler(){this.$emit("formChange",this.form)},deep:!0,immediate:!0}}}),ce={class:"chariot-form-input q-mt-md"},be={class:"chariot-form-input q-mt-md"},Se={class:"chariot-form-input q-mt-md"},$e={class:"chariot-form-input q-mt-md"},qe={class:"chariot-form-input q-mt-md"},Ve={class:"chariot-form-input q-mt-md"},ve={class:"chariot-form-input q-mt-md"},ye={class:"chariot-form-input q-mt-md"},we={class:"chariot-form-input q-mt-md"},Le={class:"chariot-form-input q-mt-md"},Te={class:"chariot-form-input q-mt-md"},Pe={class:"chariot-form-input q-mt-md"},Ue={class:"chariot-form-input q-mt-md"},Fe={class:"chariot-form-input q-mt-md"},Ae={class:"chariot-form-input q-mt-md"},Ce={class:"chariot-form-input q-mt-md"};function Me(e,t,c,$,q,g){return h(),y("div",null,[u("label",ce,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.userDnTemplate"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.userDnTemplate")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userDnTemplate,"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.userDnTemplate=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",be,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.userSearchBase"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.userSearchBase")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userSearchBase,"onUpdate:modelValue":t[1]||(t[1]=r=>e.form.userSearchBase=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",Se,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.userFullNameAttribute"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.userFullNameAttribute")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userFullNameAttribute,"onUpdate:modelValue":t[2]||(t[2]=r=>e.form.userFullNameAttribute=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",$e,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.userListFilter"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.userListFilter")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userListFilter,"onUpdate:modelValue":t[3]||(t[3]=r=>e.form.userListFilter=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",qe,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.usernameAttributeName"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.usernameAttributeName")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.userNameAttribute,"onUpdate:modelValue":t[4]||(t[4]=r=>e.form.userNameAttribute=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",Ve,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupSearchBase"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupSearchBase")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupSearchBase,"onUpdate:modelValue":t[5]||(t[5]=r=>e.form.groupSearchBase=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",ve,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupSearchFilter"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupSearchFilter")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupSearchFilter,"onUpdate:modelValue":t[6]||(t[6]=r=>e.form.groupSearchFilter=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",ye,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupNameAttribute"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupNameAttribute")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupNameAttribute,"onUpdate:modelValue":t[7]||(t[7]=r=>e.form.groupNameAttribute=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",we,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupToRoleMapping"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupToRoleMapping")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupToRoleMapping,"onUpdate:modelValue":t[8]||(t[8]=r=>e.form.groupToRoleMapping=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",Le,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupMemberAttribute"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupMemberAttribute")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupMemberAttribute,"onUpdate:modelValue":t[9]||(t[9]=r=>e.form.groupMemberAttribute=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",Te,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.groupMemberDnTemplate"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.groupMemberDnTemplate")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.groupMemberDnTemplate,"onUpdate:modelValue":t[10]||(t[10]=r=>e.form.groupMemberDnTemplate=r),dense:"",outlined:""},null,8,["modelValue"])]),o(k,{"header-class":"chariot-form-collapse-group"},{header:l(()=>[a(s(e.$t("mqttServerLdap.advancedOptions")),1)]),default:l(()=>[u("label",Pe,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.referral"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.referral")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.referral,"onUpdate:modelValue":t[11]||(t[11]=r=>e.form.referral=r),dense:"",outlined:""},null,8,["modelValue"])]),u("label",Ue,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.connectionTimeout"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.connectionTimeout")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.connectTimeout,"onUpdate:modelValue":t[12]||(t[12]=r=>e.form.connectTimeout=r),modelModifiers:{number:!0},type:"number",dense:"",outlined:""},null,8,["modelValue"])]),u("label",Fe,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.readTimeout"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.readTimeout")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.readTimeout,"onUpdate:modelValue":t[13]||(t[13]=r=>e.form.readTimeout=r),modelModifiers:{number:!0},type:"number",dense:"",outlined:""},null,8,["modelValue"])]),u("label",Ae,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.cacheTimeout"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.cacheTimeout")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.form.cacheTimeout,"onUpdate:modelValue":t[14]||(t[14]=r=>e.form.cacheTimeout=r),modelModifiers:{number:!0},type:"number",dense:"",outlined:""},null,8,["modelValue"])]),u("label",Ce,[o(i,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.enableCache"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.enableCache")),1)]),_:1})]),_:1})]),_:1}),o(w,{modelValue:e.form.enableCache,"onUpdate:modelValue":t[15]||(t[15]=r=>e.form.enableCache=r)},null,8,["modelValue"])])]),_:1})])}const Ne=L(ge,[["render",Me]]),De=T({name:"PreviewSourceModal",emits:["onClose"],components:{BasicModal:B},props:{open:{type:Boolean,default:!1},source:{type:String,default:""}},data(){return{loading:!1,showModal:this.open,sourceUserRows:[],roleUserRows:[],userColumns:[{name:"username",field:"username",label:"Username",sortable:!1,align:"left"},{name:"name",field:"name",label:"Name",sortable:!1,align:"left"},{name:"groups",field:"groups",label:"Groups",sortable:!1,align:"left"}],roleColumns:[{name:"name",field:"name",label:"Name",sortable:!1,align:"left"}],tab:"users",pagination:{rowsPerPage:0}}},watch:{open(){this.showModal=this.open}},created(){this.loadPreviewSource()},methods:{async loadPreviewSource(e){this.selectedSource={...e},this.loading=!0;try{const t=await this.$api.get(`/authsource/users/${this.source}`),c=await this.$api.get(`/authsource/roles/${this.source}`);this.sourceUserRows=t.data.results,this.roleUserRows=c.data.results}catch(t){this.$q.notify({type:"negative",message:t.response.data.message})}this.loading=!1},onClose(){this.$emit("onClose")},toggle(){this.$refs.viewSourceFormModal.toggle()}}}),Be={style:{height:"425px"},class:"chariot-modal-body"},ke={class:"chariot-groups-column"};function Qe(e,t,c,$,q,g){const r=S("BasicModal");return h(),b(r,{ref:"viewSourceFormModal",class:"q-pa-none",open:e.showModal,"show-footer":!1,"no-gutters":!0,title:"View User Source Details",onOnClose:e.onClose},{default:l(()=>[u("div",Be,[o(M,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=f=>e.tab=f),dense:"","active-color":"primary",align:"justify"},{default:l(()=>[o(F,{name:"users",label:"Users"}),o(F,{name:"roles",label:"Roles"})]),_:1},8,["modelValue"]),o(D),o(N,{modelValue:e.tab,"onUpdate:modelValue":t[3]||(t[3]=f=>e.tab=f)},{default:l(()=>[o(A,{class:"q-pa-none",name:"users"},{default:l(()=>[o(C,{pagination:e.pagination,"onUpdate:pagination":t[1]||(t[1]=f=>e.pagination=f),loading:e.loading,rows:e.sourceUserRows,columns:e.userColumns,"row-key":"username",flat:"","rows-per-page-options":[]},{"body-cell-groups":l(f=>[o(P,{props:f},{default:l(()=>[u("pre",ke,s(f.row.groups.join(`,\r
`)),1)]),_:2},1032,["props"])]),_:1},8,["pagination","loading","rows","columns"])]),_:1}),o(A,{class:"q-pa-none",name:"roles"},{default:l(()=>[o(C,{pagination:e.pagination,"onUpdate:pagination":t[2]||(t[2]=f=>e.pagination=f),loading:e.loading,rows:e.roleUserRows,columns:e.roleColumns,"row-key":"username",flat:"","rows-per-page-options":[]},null,8,["pagination","loading","rows","columns"])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["open","onOnClose"])}const Re=L(De,[["render",Qe]]),Oe=T({name:"UsersTab",components:{ADTemplate:he,LDAPTemplate:Ne,PreviewSourceModal:Re,BasicModal:B},data(){const e={sourceType:{label:"Microsoft Active Directory",value:"ad"},name:"",enabled:!0,host:"",port:"389",useTls:!1,sysUsername:"",sysPassword:""};return{showPassword:!0,loading:!1,showEditSource:!1,showPreviewSource:!1,selectedSource:null,sourceTypes:[{label:"Microsoft Active Directory",value:"ad"},{label:"LDAP",value:"ldap"}],pagination:{sortBy:"desc",descending:!1,page:1,rowsPerPage:E("sources"),rowsNumber:0},sourceForm:{...e},basicDefaults:{...e},templateForm:{},rows:[],columns:[{name:"name",field:"name",label:"Name",sortable:!1,align:"left"},{name:"type",field:"type",label:"Type",sortable:!1,align:"left"},{name:"enabled",field:"enabled",label:"Enabled",sortable:!1,align:"left"},{name:"actions",field:"actions",label:"",sortable:!1,align:"center"}]}},created(){this.updateGrid({pagination:this.pagination})},methods:{async updateGrid(e){const{page:t,rowsPerPage:c,sortBy:$,descending:q}=e.pagination;this.loading=!0,this.pagination.page=t,this.pagination.rowsPerPage=c,this.pagination.sortBy=$,this.pagination.descending=q;try{const g=await this.$api.get(`/authsource/configs?limit=${this.pagination.rowsPerPage}&offset=${this.pagination.rowsPerPage*(this.pagination.page-1)}`);this.rows=g.data.results,this.pagination.rowsNumber=g.data.info.total}catch(g){this.$q.notify({type:"negative",message:g.response.data.message})}this.loading=!1},onUpdateForm(e){this.templateForm={...e}},onClickAddSource(){this.showEditSource=!0},onCloseSource(){this.showEditSource=!1,this.selectedSource=null,this.sourceForm={sourceType:{label:"Microsoft Active Directory",value:"ad"},name:"",enabled:!0,host:"",port:"389",useTls:!1,sysUsername:"",sysPassword:""},this.templateForm={}},onClickEditSource(e){this.selectedSource={...e},this.sourceForm={sourceType:{label:e.sourceType==="ad"?"Microsoft Active Directory":"LDAP",value:e.sourceType},name:this.selectedSource.name,enabled:this.selectedSource.enabled,host:this.selectedSource.host,port:this.selectedSource.port,useTls:this.selectedSource.useTls,sysUsername:this.selectedSource.sysUsername,sysPassword:""},this.showEditSource=!0},async onClickPreviewSource(e){this.selectedSource={...e},this.showPreviewSource=!0},onClosePreviewSource(){this.selectedSource=null,this.showPreviewSource=!1},onClickDeleteSource(e){this.selectedSource={...e},this.$q.dialog({component:X,componentProps:{message:this.$t("sources.confirmDeleted"),title:this.$t("sources.deleteTitle"),type:"error",okText:this.$t("shared.delete")}}).onOk(()=>{this.onDeleteSource(this.selectedSource.name)}).onDismiss(()=>{this.selectedSource=null})},async onDeleteSource(e){try{await this.$api.delete(`/authsource/configs/${e}`),this.$q.notify({type:"positive",message:this.$t("sources.successfullyDeleted")}),this.updateGrid({pagination:this.pagination})}catch(t){this.$q.notify({type:"negative",message:t.response.data.message})}},async onSaveSourceResponse(){const e={...this.sourceForm,...this.templateForm};if(e.sourceType.value&&(e.sourceType=e.sourceType.value),this.loading=!0,this.selectedSource===null)try{await this.$api.post(`/authsource/configs/${e.name}`,e),this.$q.notify({type:"positive",message:this.$t("sources.successfullyCreated")})}catch(t){this.$q.notify({type:"negative",message:t.response.data.message})}else{e.sysPassword.length===0&&delete e.sysPassword;try{await this.$api.put(`/authsource/configs/${e.name}`,e),this.$q.notify({type:"positive",message:this.$t("sources.successfullyUpdated")})}catch(t){this.$q.notify({type:"negative",message:t.response.data.message})}}this.onCloseSource(),this.loading=!1,this.updateGrid({pagination:this.pagination})}},watch:{"pagination.rowsPerPage":{handler(){O("sources",this.pagination.rowsPerPage)}}}}),Ee={key:0},Ge={key:1},je={class:"chariot-form-input"},Ie={class:"chariot-form-input q-mt-md"},He={class:"chariot-form-input q-mt-md"},Ke={class:"chariot-form-input"},Xe={class:"chariot-form-input q-mt-md"},Ye={class:"chariot-form-input q-mt-md"},ze={class:"chariot-form-input"},Je={class:"chariot-form-input q-mt-md"};function We(e,t,c,$,q,g){const r=S("ADTemplate"),f=S("LDAPTemplate"),V=S("BasicModal"),Q=S("PreviewSourceModal");return h(),y("div",null,[o(C,{onRequest:e.updateGrid,loading:e.loading,rows:e.rows,columns:e.columns,pagination:e.pagination,"onUpdate:pagination":t[0]||(t[0]=p=>e.pagination=p),"rows-per-page-options":[0],"row-key":"name"},{top:l(()=>[o(v,{color:"primary",label:"Add Source",onClick:e.onClickAddSource},null,8,["onClick"])]),"body-cell-type":l(p=>[o(P,{props:p},{default:l(()=>[p.row.sourceType==="ad"?(h(),y("span",Ee," Microsoft Active Directory ")):(h(),y("span",Ge," LDAP "))]),_:2},1032,["props"])]),"body-cell-enabled":l(p=>[o(P,{props:p},{default:l(()=>[p.row.enabled===!0?(h(),b(m,{key:0,color:"positive",name:"check"})):(h(),b(m,{key:1,name:"close",color:"negative"}))]),_:2},1032,["props"])]),"body-cell-actions":l(p=>[o(P,{props:p},{default:l(()=>[o(v,{onClick:()=>e.onClickEditSource(p.row),flat:"",round:"",color:"primary-light",icon:"edit"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("sources.editSource")),1)]),_:1})]),_:1},8,["onClick"]),o(v,{onClick:()=>e.onClickPreviewSource(p.row),flat:"",round:"",color:"primary-light",icon:"preview"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("sources.previewSource")),1)]),_:1})]),_:1},8,["onClick"]),o(v,{onClick:()=>e.onClickDeleteSource(p.row),flat:"",round:"",color:"negative",icon:"delete"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("sources.deleteSource")),1)]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["onRequest","loading","rows","columns","pagination"]),o(V,{ref:"editSourceFormModal",open:e.showEditSource,"show-footer":!0,title:e.selectedSource===null?"Add Source":"Edit Source",loading:e.loading,onOnClose:e.onCloseSource,onOnSave:e.onSaveSourceResponse},{default:l(()=>[o(K,{class:"q-gutter-y-md column"},{default:l(()=>[u("div",null,[u("label",je,[o(i,{class:"q-mb-sm"},{default:l(()=>[...t[10]||(t[10]=[a(" Source Type ",-1)])]),_:1}),o(H,{modelValue:e.sourceForm.sourceType,"onUpdate:modelValue":t[1]||(t[1]=p=>e.sourceForm.sourceType=p),disable:e.selectedSource!==null,outlined:"",dense:"",options:e.sourceTypes},null,8,["modelValue","disable","options"])]),u("label",Ie,[o(i,{class:"q-mb-sm"},{default:l(()=>[t[11]||(t[11]=a(" Name ",-1)),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("sources.tooltips.name")),1)]),_:1})]),_:1})]),_:1}),o(d,{disable:e.selectedSource!==null,modelValue:e.sourceForm.name,"onUpdate:modelValue":t[2]||(t[2]=p=>e.sourceForm.name=p),dense:"",outlined:""},null,8,["disable","modelValue"])]),u("label",He,[o(i,null,{default:l(()=>[a(s(e.$t("shared.enabled"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.enabled")),1)]),_:1})]),_:1})]),_:1}),o(w,{modelValue:e.sourceForm.enabled,"onUpdate:modelValue":t[3]||(t[3]=p=>e.sourceForm.enabled=p)},null,8,["modelValue"])]),u("label",Ke,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.host"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.host")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.sourceForm.host,"onUpdate:modelValue":t[4]||(t[4]=p=>e.sourceForm.host=p),dense:"",outlined:""},null,8,["modelValue"])]),u("label",Xe,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("shared.port"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.port")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.sourceForm.port,"onUpdate:modelValue":t[5]||(t[5]=p=>e.sourceForm.port=p),dense:"",outlined:""},null,8,["modelValue"])]),u("label",Ye,[o(i,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.useTls"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.useTls")),1)]),_:1})]),_:1})]),_:1}),o(w,{modelValue:e.sourceForm.useTls,"onUpdate:modelValue":t[6]||(t[6]=p=>e.sourceForm.useTls=p)},null,8,["modelValue"])]),u("label",ze,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.systemUsername"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.systemUsername")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.sourceForm.sysUsername,"onUpdate:modelValue":t[7]||(t[7]=p=>e.sourceForm.sysUsername=p),dense:"",outlined:""},null,8,["modelValue"])]),u("label",Je,[o(i,{class:"q-mb-sm"},{default:l(()=>[a(s(e.$t("mqttServerLdap.systemPassword"))+" ",1),o(m,{color:"light",name:"help"},{default:l(()=>[o(n,null,{default:l(()=>[a(s(e.$t("mqttServerLdap.tooltips.systemPassword")),1)]),_:1})]),_:1})]),_:1}),o(d,{modelValue:e.sourceForm.sysPassword,"onUpdate:modelValue":t[9]||(t[9]=p=>e.sourceForm.sysPassword=p),outlined:"",dense:"",type:e.showPassword?"password":"text"},{append:l(()=>[o(v,{flat:"",dense:"",rounded:"",icon:e.showPassword?"visibility_off":"visibility",class:"cursor-pointer",onClick:t[8]||(t[8]=p=>e.showPassword=!e.showPassword)},null,8,["icon"])]),_:1},8,["modelValue","type"])]),e.sourceForm.sourceType.value==="ad"?(h(),b(r,{key:0,onFormChange:e.onUpdateForm,"form-values":e.selectedSource},null,8,["onFormChange","form-values"])):(h(),b(f,{key:1,onFormChange:e.onUpdateForm,"form-values":e.selectedSource},null,8,["onFormChange","form-values"]))])]),_:1})]),_:1},8,["open","title","loading","onOnClose","onOnSave"]),e.selectedSource!==null?(h(),b(Q,{key:0,open:e.showPreviewSource,source:e.selectedSource.name,onOnClose:e.onClosePreviewSource},null,8,["open","source","onOnClose"])):R("",!0)])}const Ze=L(Oe,[["render",We]]),_e=T({name:"SourcesPage",components:{PageHeader:I,UsersTab:Ze},data(){let e="users";return this.$route?.query?.tab?e=this.$route?.query?.tab:this.$router.replace({name:"sources",query:{tab:e}}),{tab:e}},watch:{tab(){this.$router.push({name:"sources",query:{...this.$route.query,tab:this.tab}})},$route:{handler(){this.$route.query.tab&&(this.tab=this.$route.query.tab)}}}});function xe(e,t,c,$,q,g){const r=S("PageHeader"),f=S("UsersTab");return h(),b(j,{class:"chariot-page-container"},{default:l(()=>[o(r,{title:"User Sources",icon:"source"}),o(G,{class:"chariot-page-container-body"},{default:l(()=>[o(M,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=V=>e.tab=V),dense:"","active-color":"primary-light",align:"justify"},{default:l(()=>[o(F,{name:"users",label:"Users"})]),_:1},8,["modelValue"]),o(D),o(N,{modelValue:e.tab,"onUpdate:modelValue":t[1]||(t[1]=V=>e.tab=V)},{default:l(()=>[o(A,{name:"users"},{default:l(()=>[o(f)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}const $o=L(_e,[["render",xe]]);export{$o as default};
