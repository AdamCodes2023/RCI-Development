import{_ as g,d as y,M as $,N as c,O as n,$ as B,ax as v,aq as w,f as t,au as p,P as o,q as d,Q as u,aF as m,S as h,V as k,W as f}from"./index-NBAmjDPo.js";import{Q as q}from"./QInnerLoading-DLOuihN2.js";import{Q as C}from"./QPage-vWYdfFDK.js";import{P as _}from"./PageHeader-Bnmx8R_2.js";import"./QMenu-ikSdQUIb.js";const x=y({name:"BackupPage",components:{PageHeader:_},data(){return{loading:!1}},methods:{async exportBackup(){const e={...this.$baseHeader};e.responseType="blob",e.headers.Authorization=`bearer ${this.authToken}`;const a=this.$axios.create(e);this.loading=!0;try{const s=await a.post("/backup?action=export"),i=window.URL.createObjectURL(new Blob([s.data])),r=document.createElement("a");r.href=i,r.setAttribute("download","backup.zip"),document.body.appendChild(r),r.click(),r.remove()}catch(s){this.$q.notify({type:"negative",message:s.response.data.message})}this.loading=!1},async restoreBackup(e){const a={...this.$baseHeader},s=new FormData;a.headers["Content-Type"]="multipart/form-data",a.headers.Authorization=`bearer ${this.authToken}`,s.append("backup",e.target.files[0]);const i=this.$axios.create(a);this.loading=!0;try{await i.post("/backup?action=import",s),this.$q.notify({type:"positive",message:this.$t("backup.backupImportSuccess")})}catch{this.$q.notify({type:"negative",message:this.$t("backup.backupImportFailed")})}this.loading=!1}},computed:{...B(v,["authToken"])}}),P={class:"row"},Q={class:"offset-2 col-4"},H={class:"chariot-backup-card-body q-hoverable q-mr-md"},z={class:"col-4 q-ml-md"},S={class:"chariot-backup-card-body q-hoverable q-mr-md"};function D(e,a,s,i,r,R){const b=w("PageHeader");return c(),$(C,{class:"chariot-page-container"},{default:n(()=>[t(b,{title:"Backup",icon:"save_alt"}),t(p,{class:"chariot-page-container-body q-pa-md"},{default:n(()=>[o("div",P,[o("div",Q,[t(p,{class:"chariot-backup-card",onClick:e.exportBackup},{default:n(()=>[d((c(),u("div",H,[a[3]||(a[3]=o("span",{class:"q-focus-helper"},null,-1)),t(m,null,{default:n(()=>[t(h,{class:"text-primary",size:"75px",name:"download"}),o("h5",null,k(e.$t("backup.exportBackup")),1)]),_:1})])),[[f]])]),_:1},8,["onClick"])]),o("div",z,[t(p,{class:"chariot-backup-card",onClick:a[2]||(a[2]=l=>e.$refs.restoreBackup.click())},{default:n(()=>[d((c(),u("div",S,[a[4]||(a[4]=o("span",{class:"q-focus-helper"},null,-1)),t(m,null,{default:n(()=>[t(h,{class:"text-primary",size:"75px",name:"upload"}),o("h5",null,k(e.$t("backup.restoreBackup")),1),o("input",{type:"file",ref:"restoreBackup",style:{display:"none"},onClick:a[0]||(a[0]=l=>{l.target.value=null}),onChange:a[1]||(a[1]=(...l)=>e.restoreBackup&&e.restoreBackup(...l))},null,544)]),_:1})])),[[f]])]),_:1})])]),t(q,{showing:e.loading,color:"primary",label:"Loading...","label-style":"font-size: 1.1em"},null,8,["showing"])]),_:1})]),_:1})}const N=g(x,[["render",D]]);export{N as default};
